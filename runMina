dockerName=gcr.io/o1labs-192920/mina-daemon:1.2.0beta2-23842ac-mainnet
##dockerName=gcr.io/o1labs-192920/mina-daemon:1.1.6alpha4-74793a2-devnet

docker network rm mina-network

docker network create mina-network
cat $HOME/keys/my-wallet.pub
echo ""
echo "If enter key wron press ctrl+c and copy correct key to $HOME/keys/"
echo "press Enter to continue"
read
echo "enter password"
read pas
cd
docker stop mina
docker rm -f mina
docker stop mina-sidecar
docker rm -f mina-sidecar
systemctl stop mina
echo y | docker network prune
mkdir keys
chmod 700 $HOME/keys
chmod 600 $HOME/keys/my-wallet
rm runMina
sudo rm $HOME/.coda-config -r
docker network create mina-network
sudo docker run --name mina -d \
--restart always \
--network mina-network \
-p 8302:8302 \
-p 3095:3095 \
-v $(pwd)/keys:$HOME/keys:ro \
-v $(pwd)/.coda-config:$HOME/.coda-config \
-e CODA_PRIVKEY_PASS=$pas \
$dockerName \
daemon \
-block-producer-key $HOME/keys/my-wallet \
-block-producer-password $pas \
--open-limited-graphql-port \
--limited-graphql-port 3095 \
-insecure-rest-server \
-file-log-level Debug \
-log-level Info \
-peer-list-url https://storage.googleapis.com/mina-seed-lists/mainnet_seeds.txt \
-archive-address 3086

cd $HOME && touch mina-sidecar-config.json
cat << EOF > mina-sidecar-config.json
{
  "uploadURL": "https://us-central1-mina-mainnet-303900.cloudfunctions.net/block-producer-stats-ingest/?token=72941420a9595e1f4006e2f3565881b5",
  "nodeURL": "http://mina:3095"
}
EOF

docker run \
--name mina-sidecar \
--network mina-network \
--restart=always -d \
-v $(pwd)/mina-sidecar-config.json:/etc/mina-sidecar.json \
minaprotocol/mina-bp-stats-sidecar:latest

